<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="sub1_stock" language="groovy" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="5" bottomMargin="5" uuid="dc191b01-7832-4ffb-b321-d70d0af9b524">
	<property name="ireport.zoom" value="2.5937424601000143"/>
	<property name="ireport.x" value="22"/>
	<property name="ireport.y" value="0"/>
	<parameter name="DES_ARMAZEM" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT DISTINCT
     tb_produto.`designacao` AS tb_produto_designacao,
     tb_stock.`quantidade_existente` AS tb_stock_quantidade_existente,
     tb_tipo_produto.`codigo` AS tb_tipo_produto_codigo,
     tb_tipo_produto.`designacao` AS tb_tipo_produto_designacao,
     tb_produto.`codigo` AS tb_produto_codigo,
     tb_armazem.`designacao` AS tb_armazem_designacao,

      ( SELECT  MAX(tb_preco.`pk_preco`) AS MAX_PRECO FROM `tb_preco` tb_preco WHERE tb_preco.`fk_produto`  =  tb_produto.`codigo`)
      AS MAX_COD_PRECO,

     ( SELECT  tb_preco.`preco_compra` AS M_P FROM `tb_preco` tb_preco WHERE tb_preco.`pk_preco`  =  MAX_COD_PRECO)
      AS MAX_PRECO_COMPRA,


    ( SELECT  MAX(tb_preco.`preco_venda`) AS M_V FROM `tb_preco` tb_preco WHERE tb_preco.`pk_preco`  =  MAX_COD_PRECO)
      AS MAX_PRECO_VENDA,


    ( SELECT  MAX(tb_preco.`percentagem_ganho`) AS MAX_PRECO_COMPRA FROM `tb_preco` tb_preco WHERE tb_preco.`pk_preco`  =  MAX_COD_PRECO)
      AS MAX_PERCENTAGEM_GANHO

FROM
     `tb_produto` tb_produto INNER JOIN `tb_stock` tb_stock ON tb_produto.`codigo` = tb_stock.`cod_produto_codigo`
     INNER JOIN `tb_tipo_produto` tb_tipo_produto ON tb_produto.`cod_Tipo_Produto` = tb_tipo_produto.`codigo`
     INNER JOIN `tb_armazem` tb_armazem ON tb_stock.`cod_armazem` = tb_armazem.`codigo`

WHERE

     tb_armazem.`designacao` = $P{DES_ARMAZEM} AND tb_produto.`status` = 'Activo'

ORDER BY
     tb_produto.`codigo` ASC]]>
	</queryString>
	<field name="tb_produto_designacao" class="java.lang.String"/>
	<field name="tb_stock_quantidade_existente" class="java.lang.Integer"/>
	<field name="tb_tipo_produto_codigo" class="java.lang.Integer"/>
	<field name="tb_tipo_produto_designacao" class="java.lang.String"/>
	<field name="tb_produto_codigo" class="java.lang.Integer"/>
	<field name="tb_armazem_designacao" class="java.lang.String"/>
	<field name="MAX_COD_PRECO" class="java.math.BigInteger"/>
	<field name="MAX_PRECO_COMPRA" class="java.lang.Double"/>
	<field name="MAX_PRECO_VENDA" class="java.lang.Double"/>
	<field name="MAX_PERCENTAGEM_GANHO" class="java.lang.Double"/>
	<variable name="SOMA_QUANTIDADES" class="java.lang.Integer" calculation="Sum">
		<variableExpression><![CDATA[$F{tb_stock_quantidade_existente}]]></variableExpression>
	</variable>
	<variable name="SOMA_PRECO_COMPRA" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{tb_stock_quantidade_existente}*$F{MAX_PRECO_COMPRA}]]></variableExpression>
	</variable>
	<variable name="SOMA_PRECO_VENDA" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{tb_stock_quantidade_existente}*$F{MAX_PRECO_VENDA}]]></variableExpression>
	</variable>
	<variable name="SOMA_LUCRO" class="java.lang.Double"/>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="34">
			<rectangle>
				<reportElement uuid="a55bb01a-31bc-4d6c-8d3b-a1f4f60b7615" x="0" y="0" width="555" height="34" forecolor="#666666" backcolor="#666666"/>
			</rectangle>
			<staticText>
				<reportElement uuid="9d96ded0-b2df-4509-a2e4-8ce41b21c241" x="11" y="0" width="498" height="34" forecolor="#FFFFFF"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" markup="none">
					<font fontName="Times New Roman" size="20" isBold="true"/>
				</textElement>
				<text><![CDATA[RESUMO GERAL]]></text>
			</staticText>
		</band>
	</title>
	<columnHeader>
		<band height="27" splitType="Stretch">
			<staticText>
				<reportElement uuid="080f29ac-0968-48f3-93e6-55e810ef7ca8" x="0" y="0" width="136" height="27" forecolor="#000000"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineColor="#666666"/>
					<topPen lineWidth="0.0" lineColor="#666666"/>
					<leftPen lineWidth="0.0" lineColor="#666666"/>
					<bottomPen lineColor="#666666"/>
					<rightPen lineWidth="0.0" lineColor="#666666"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Verdana" size="16" isBold="true"/>
				</textElement>
				<text><![CDATA[LEGENDA]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="2be9d6b1-8d71-406e-885b-164eb1b8c5ff" x="275" y="0" width="159" height="27" forecolor="#000000"/>
				<box leftPadding="2" rightPadding="2">
					<pen lineColor="#666666"/>
					<topPen lineWidth="0.0" lineColor="#666666"/>
					<leftPen lineWidth="0.0" lineColor="#666666"/>
					<bottomPen lineColor="#666666"/>
					<rightPen lineWidth="0.0" lineColor="#666666"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Verdana" size="16" isBold="true"/>
				</textElement>
				<text><![CDATA[TOTAIS]]></text>
			</staticText>
		</band>
	</columnHeader>
	<summary>
		<band height="180" splitType="Stretch">
			<rectangle>
				<reportElement uuid="779fb5aa-31a0-4f80-b77b-d725e5a632b1" x="275" y="0" width="280" height="112" forecolor="#FFFFFF" backcolor="#CCCCCC"/>
			</rectangle>
			<textField pattern="#,##0.00">
				<reportElement uuid="9c2e19e5-55e5-4966-9184-f01b3eb56406" x="310" y="23" width="199" height="19" forecolor="#006600"/>
				<box leftPadding="2">
					<pen lineStyle="Solid" lineColor="#666666"/>
					<topPen lineStyle="Solid" lineColor="#666666"/>
					<leftPen lineStyle="Solid" lineColor="#666666"/>
					<bottomPen lineWidth="0.25" lineStyle="Solid" lineColor="#666666"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#666666"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Times New Roman" size="15" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SOMA_QUANTIDADES}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement uuid="050d8319-a3b9-4285-a502-f1ea12267b8f" x="311" y="79" width="198" height="18" forecolor="#0033CC"/>
				<box leftPadding="2">
					<pen lineStyle="Solid" lineColor="#666666"/>
					<topPen lineStyle="Solid" lineColor="#666666"/>
					<leftPen lineStyle="Solid" lineColor="#666666"/>
					<bottomPen lineWidth="0.25" lineStyle="Solid" lineColor="#666666"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#666666"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Times New Roman" size="15" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SOMA_PRECO_VENDA} - $V{SOMA_PRECO_COMPRA}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement uuid="163f5838-4d88-4eac-a183-334defc5ba67" x="311" y="61" width="198" height="18" forecolor="#000000"/>
				<box leftPadding="2">
					<pen lineStyle="Solid" lineColor="#666666"/>
					<topPen lineStyle="Solid" lineColor="#666666"/>
					<leftPen lineStyle="Solid" lineColor="#666666"/>
					<bottomPen lineWidth="0.25" lineStyle="Solid" lineColor="#666666"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#666666"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Times New Roman" size="15" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SOMA_PRECO_VENDA}]]></textFieldExpression>
			</textField>
			<rectangle>
				<reportElement uuid="fefe3894-78de-4dab-8d83-c0b5a6255d00" x="0" y="0" width="265" height="130" forecolor="#FFFFFF" backcolor="#CCCCCC"/>
			</rectangle>
			<staticText>
				<reportElement uuid="639b24ec-4b19-4e75-a7dd-672793e6c448" x="0" y="6" width="34" height="19" forecolor="#000000"/>
				<box leftPadding="2">
					<pen lineColor="#666666"/>
					<topPen lineWidth="0.0" lineColor="#666666"/>
					<leftPen lineWidth="0.0" lineColor="#666666"/>
					<bottomPen lineColor="#666666"/>
					<rightPen lineWidth="0.0" lineColor="#666666"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[Qtd]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="01728e14-5b75-44a2-8cbd-d38b73d05758" x="0" y="25" width="34" height="19" forecolor="#000000"/>
				<box leftPadding="2">
					<pen lineColor="#666666"/>
					<topPen lineWidth="0.0" lineColor="#666666"/>
					<leftPen lineWidth="0.0" lineColor="#666666"/>
					<bottomPen lineColor="#666666"/>
					<rightPen lineWidth="0.0" lineColor="#666666"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[PC]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="072dcf04-db6e-45e5-8e46-b80762aec36d" x="0" y="62" width="34" height="19" forecolor="#000000"/>
				<box leftPadding="2">
					<pen lineColor="#666666"/>
					<topPen lineWidth="0.0" lineColor="#666666"/>
					<leftPen lineWidth="0.0" lineColor="#666666"/>
					<bottomPen lineColor="#666666"/>
					<rightPen lineWidth="0.0" lineColor="#666666"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[TC]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="0d8c71a3-46ab-497f-b2c3-77bb5b1ca61c" x="0" y="80" width="34" height="19" forecolor="#000000"/>
				<box leftPadding="2">
					<pen lineColor="#666666"/>
					<topPen lineWidth="0.0" lineColor="#666666"/>
					<leftPen lineWidth="0.0" lineColor="#666666"/>
					<bottomPen lineColor="#666666"/>
					<rightPen lineWidth="0.0" lineColor="#666666"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[TV]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="b4234caf-4995-4819-9798-22713e6a471c" x="0" y="100" width="34" height="19" forecolor="#000000"/>
				<box leftPadding="2">
					<pen lineColor="#666666"/>
					<topPen lineWidth="0.0" lineColor="#666666"/>
					<leftPen lineWidth="0.0" lineColor="#666666"/>
					<bottomPen lineColor="#666666"/>
					<rightPen lineWidth="0.0" lineColor="#666666"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[LE]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="46abddfc-500d-4ce5-98b3-d35b849c33b4" x="34" y="6" width="122" height="19" forecolor="#000000"/>
				<box leftPadding="2">
					<pen lineColor="#666666"/>
					<topPen lineWidth="0.0" lineColor="#666666"/>
					<leftPen lineWidth="0.0" lineColor="#666666"/>
					<bottomPen lineColor="#666666"/>
					<rightPen lineWidth="0.0" lineColor="#666666"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Times New Roman" size="10" isBold="false" isItalic="true"/>
				</textElement>
				<text><![CDATA[Quantidade]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="7285a145-8811-47bd-98c6-0ebffdfb231d" x="34" y="25" width="122" height="19" forecolor="#000000"/>
				<box leftPadding="2">
					<pen lineColor="#666666"/>
					<topPen lineWidth="0.0" lineColor="#666666"/>
					<leftPen lineWidth="0.0" lineColor="#666666"/>
					<bottomPen lineColor="#666666"/>
					<rightPen lineWidth="0.0" lineColor="#666666"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Times New Roman" size="10" isBold="false" isItalic="true"/>
				</textElement>
				<text><![CDATA[Preço da Compra]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="cc6a27cb-e28e-4fe5-8ba6-560c8bfda0d7" x="34" y="62" width="122" height="19" forecolor="#000000"/>
				<box leftPadding="2">
					<pen lineColor="#666666"/>
					<topPen lineWidth="0.0" lineColor="#666666"/>
					<leftPen lineWidth="0.0" lineColor="#666666"/>
					<bottomPen lineColor="#666666"/>
					<rightPen lineWidth="0.0" lineColor="#666666"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Times New Roman" size="10" isBold="false" isItalic="true"/>
				</textElement>
				<text><![CDATA[Total das Compras]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="57cb3521-e49e-4f93-a444-97a8499eef22" x="34" y="80" width="122" height="19" forecolor="#000000"/>
				<box leftPadding="2">
					<pen lineColor="#666666"/>
					<topPen lineWidth="0.0" lineColor="#666666"/>
					<leftPen lineWidth="0.0" lineColor="#666666"/>
					<bottomPen lineColor="#666666"/>
					<rightPen lineWidth="0.0" lineColor="#666666"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Times New Roman" size="10" isBold="false" isItalic="true"/>
				</textElement>
				<text><![CDATA[Total das Vendas]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="86a5de9c-38d3-44aa-885e-549253d8c404" x="34" y="100" width="122" height="19" forecolor="#000000"/>
				<box leftPadding="2">
					<pen lineColor="#666666"/>
					<topPen lineWidth="0.0" lineColor="#666666"/>
					<leftPen lineWidth="0.0" lineColor="#666666"/>
					<bottomPen lineColor="#666666"/>
					<rightPen lineWidth="0.0" lineColor="#666666"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Times New Roman" size="10" isBold="false" isItalic="true"/>
				</textElement>
				<text><![CDATA[Lucro Estimativo]]></text>
			</staticText>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement uuid="59e9dffe-b5c8-4ea7-b526-80fdeb7ea5a4" x="311" y="43" width="198" height="18" forecolor="#000000"/>
				<box leftPadding="2">
					<pen lineStyle="Solid" lineColor="#666666"/>
					<topPen lineStyle="Solid" lineColor="#666666"/>
					<leftPen lineStyle="Solid" lineColor="#666666"/>
					<bottomPen lineWidth="0.25" lineStyle="Solid" lineColor="#666666"/>
					<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#666666"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Times New Roman" size="15" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{SOMA_PRECO_COMPRA}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="7323b6e4-6ed0-4aa8-b8cc-b5f0965d1f56" x="276" y="23" width="34" height="19" forecolor="#000000"/>
				<box leftPadding="2">
					<pen lineColor="#666666"/>
					<topPen lineWidth="0.0" lineColor="#666666"/>
					<leftPen lineWidth="0.0" lineColor="#666666"/>
					<bottomPen lineColor="#666666"/>
					<rightPen lineWidth="0.0" lineColor="#666666"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="13" isBold="true"/>
				</textElement>
				<text><![CDATA[Qtd]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="cc835776-5945-422a-8f64-072adffccbf6" x="276" y="42" width="35" height="19" forecolor="#000000"/>
				<box leftPadding="2">
					<pen lineColor="#666666"/>
					<topPen lineWidth="0.0" lineColor="#666666"/>
					<leftPen lineWidth="0.0" lineColor="#666666"/>
					<bottomPen lineColor="#666666"/>
					<rightPen lineWidth="0.0" lineColor="#666666"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="13" isBold="true"/>
				</textElement>
				<text><![CDATA[TC]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="174a7294-8a4d-47bc-986d-bb85a394d3f9" x="277" y="61" width="34" height="19" forecolor="#000000"/>
				<box leftPadding="2">
					<pen lineColor="#666666"/>
					<topPen lineWidth="0.0" lineColor="#666666"/>
					<leftPen lineWidth="0.0" lineColor="#666666"/>
					<bottomPen lineColor="#666666"/>
					<rightPen lineWidth="0.0" lineColor="#666666"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="13" isBold="true"/>
				</textElement>
				<text><![CDATA[TV]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="4212713a-38dd-4acd-b943-b195b2e8090d" x="277" y="80" width="34" height="19" forecolor="#000000"/>
				<box leftPadding="2">
					<pen lineColor="#666666"/>
					<topPen lineWidth="0.0" lineColor="#666666"/>
					<leftPen lineWidth="0.0" lineColor="#666666"/>
					<bottomPen lineColor="#666666"/>
					<rightPen lineWidth="0.0" lineColor="#666666"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="13" isBold="true"/>
				</textElement>
				<text><![CDATA[LE]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="e451e695-857b-46f9-885c-4fc84ecab8de" x="0" y="44" width="34" height="19" forecolor="#000000"/>
				<box leftPadding="2">
					<pen lineColor="#666666"/>
					<topPen lineWidth="0.0" lineColor="#666666"/>
					<leftPen lineWidth="0.0" lineColor="#666666"/>
					<bottomPen lineColor="#666666"/>
					<rightPen lineWidth="0.0" lineColor="#666666"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Times New Roman" size="10" isBold="true"/>
				</textElement>
				<text><![CDATA[PV]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="7cfca9c5-a525-40d6-8922-d5008d16792d" x="34" y="44" width="122" height="19" forecolor="#000000"/>
				<box leftPadding="2">
					<pen lineColor="#666666"/>
					<topPen lineWidth="0.0" lineColor="#666666"/>
					<leftPen lineWidth="0.0" lineColor="#666666"/>
					<bottomPen lineColor="#666666"/>
					<rightPen lineWidth="0.0" lineColor="#666666"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Times New Roman" size="10" isBold="false" isItalic="true"/>
				</textElement>
				<text><![CDATA[Preço de Venda]]></text>
			</staticText>
		</band>
	</summary>
</jasperReport>
